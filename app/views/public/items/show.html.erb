<div class="container">
  <div class="row m-3">
    <!-- ジャンル検索のカラム -->
    <div class="col-md-3 mt-2">
      <table class="table genre-search-table">
        <thead class="bg-light">
          <tr>
            <th style="font-weight: bold;">ジャンル検索</th>
          </tr>
        </thead>
        <tbody>
          <% Genre.all.each do |genre| %>
            <tr>
              <td style="font-weight: normal;">
                <%= link_to genre.name, items_path(genre_id: genre.id) %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>

<!-- 商品詳細表示のカラム -->
<div class="col-md-9">
  <div class="row">
    <!-- 商品画像 -->
    <div class="col-md-12">
      <%= image_tag @item.image, width: "300px", height: "auto", style: "margin-top: 5px;" %>
    </div>
      <!-- 商品の詳細 -->
      <div class="col-md-12">
        <h2><%= @item.name %></h2>
        <p><%= @item.introduction %></p>
        <!-- 価格表示 -->
        <div style="font-size: 30px; font-weight: bold; margin-top: 10px;">
          ¥ <%= number_with_delimiter(@item.price) %><small style="font-size: 18px; font-weight: normal;"> (税込)</small>
        </div>
        <!-- 数量選択とカート追加 -->
        <%= form_with model: @item, url: cart_items_path, local: true do |f| %>
          <div style="display: flex; align-items: center; margin-top: 10px;">
            <%= f.number_field :quantity, in: 1..10, step: 1, class: 'form-control', style: 'width: 130px; display: inline-block; margin-right: 10px;', placeholder: '個数選択' %>
            <%= f.submit "カートに追加", class: "btn btn-primary", style: 'align-self: center;' %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const form = document.querySelector('form');
  const submitButton = form.querySelector('input[type="submit"]');
  const quantityInput = form.querySelector('input[name="quantity"]');

  form.addEventListener('submit', function(event) {
    console.log('フォームが送信されようとしています', '入力数値:', quantityInput.value);
    const quantityValue = parseInt(quantityInput.value, 10);
    // 数量が1~99の範囲外か、空の場合
    if (!quantityValue || quantityValue < 1 || quantityValue > 99) {
      event.preventDefault(); // フォーム送信を阻止
      alert('数量は1から99の間で入力してください。');
    }
  });
});
</script>